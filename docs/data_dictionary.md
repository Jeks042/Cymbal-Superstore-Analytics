# Data Dictionary — Cymbal Superstore Analytics

This document defines the core tables, metrics, and engineered features used across the Cymbal Superstore analytics project.  
It is intended to ensure metric consistency, interpretability, and correct downstream usage.

---

## 1. Core Dimensions

### dim_customer
**Grain:** One row per unique customer

| Column | Type | Description |
|------|------|------------|
| customer_unique_id | text | Stable unique identifier for each customer |
| segment_name | text | Behavioural segment assigned using RFM logic |
| churned | integer | Churn flag (1 = churned, 0 = active), based on 180-day inactivity |
| churn_risk | double | Predicted churn probability from the logistic regression model |
| risk_decile | integer | Customer churn risk decile (0 = lowest, 9 = highest) |
| priority_band | text | Value-based prioritisation band (LOW / MEDIUM / HIGH) |
| value_at_risk | double | Expected revenue loss = churn_risk × monetary |

---

## 2. Behavioural Metrics (Customer-Level)

| Column | Description |
|------|------------|
| frequency | Total number of completed orders |
| monetary | Total lifetime revenue generated by the customer |
| avg_order_value | Average value per order |
| avg_items_per_order | Average number of items per order |
| avg_category_diversity | Average number of distinct product categories per order |
| tenure_days | Days between first and last purchase |
| recency_days | Days since most recent purchase |
| avg_days_between_orders | Mean inter-purchase gap (9999 used for single-order customers) |

---

## 3. Time-Windowed Features

All time-windowed features are computed relative to the customer’s most recent activity date.

| Column | Description |
|------|------------|
| spend_30d | Total spend in the last 30 days |
| spend_90d | Total spend in the last 90 days |
| spend_180d | Total spend in the last 180 days |
| orders_30d | Number of orders in the last 30 days |
| orders_90d | Number of orders in the last 90 days |
| orders_180d | Number of orders in the last 180 days |
| recent_order_ratio | orders_30d / frequency |
| recent_spend_ratio | spend_30d / monetary |

Missing values for time-windowed features indicate no activity in the window and are set to zero.

---

## 4. Orders Fact Table

### customer_orders_enriched
**Grain:** One row per order

| Column | Description |
|------|------------|
| order_id | Unique order identifier |
| customer_unique_id | Customer identifier |
| order_purchase_timestamp | Timestamp of order placement |
| order_value | Total order revenue |
| fiscal_year | Fiscal year (starts 1 April) |
| month | Calendar month |
| cohort_month | Customer’s first purchase month |

---

## 5. Cohort Tables

### cohort_retention / cohort_retention_by_segment

**Grain:** One row per (cohort_month × month_index × segment)

| Column | Description |
|------|------------|
| cohort_month | Month of first purchase |
| month_index | Number of months since first purchase |
| cohort_size | Number of customers entering the cohort (month_index = 0) |
| retained_customers | Customers active in the given month_index |
| retention_rate | retained_customers / cohort_size |

Retention metrics are cohort-relative and should not be aggregated across time.
